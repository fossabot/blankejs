!function(){return function t(e,r,i){function a(s,h){if(!r[s]){if(!e[s]){var l="function"==typeof require&&require;if(!h&&l)return l(s,!0);if(n)return n(s,!0);var o=new Error("Cannot find module '"+s+"'");throw o.code="MODULE_NOT_FOUND",o}var u=r[s]={exports:{}};e[s][0].call(u.exports,function(t){return a(e[s][1][t]||t)},u,u.exports,t,e,r,i)}return r[s].exports}for(var n="function"==typeof require&&require,s=0;s<i.length;s++)a(i[s]);return a}}()({1:[function(t,e,r){"use strict";e.exports={Simple:t("./simple"),SpatialHash:t("./spatial-hash")}},{"./simple":2,"./spatial-hash":3}],2:[function(t,e,r){"use strict";var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}();var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.visible=e.visible||"visible",this.calculatePIXI=void 0===e.calculatePIXI||e.calculatePIXI,this.dirtyTest=void 0===e.dirtyTest||e.dirtyTest,this.AABB=e.AABB||"AABB",this.lists=[[]]}return i(t,[{key:"addList",value:function(t,e){if(this.lists.push(t),e&&(t.staticObject=!0),this.calculatePIXI&&this.dirtyTest){var r=!0,i=!1,a=void 0;try{for(var n,s=t[Symbol.iterator]();!(r=(n=s.next()).done);r=!0){var h=n.value;this.updateObject(h)}}catch(t){i=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}}return t}},{key:"removeList",value:function(t){return this.lists.splice(this.lists.indexOf(t),1),t}},{key:"add",value:function(t,e){return e&&(t.staticObject=!0),this.calculatePIXI&&(this.dirtyTest||e)&&this.updateObject(t),this.lists[0].push(t),t}},{key:"remove",value:function(t){return this.lists[0].splice(this.lists[0].indexOf(t),1),t}},{key:"cull",value:function(t,e){this.calculatePIXI&&!e&&this.updateObjects();var r=!0,i=!1,a=void 0;try{for(var n,s=this.lists[Symbol.iterator]();!(r=(n=s.next()).done);r=!0){var h=n.value,l=!0,o=!1,u=void 0;try{for(var c,y=h[Symbol.iterator]();!(l=(c=y.next()).done);l=!0){var v=c.value,f=v[this.AABB];v[this.visible]=f.x+f.width>t.x&&f.x<t.x+t.width&&f.y+f.height>t.y&&f.y<t.y+t.height}}catch(t){o=!0,u=t}finally{try{!l&&y.return&&y.return()}finally{if(o)throw u}}}}catch(t){i=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}}},{key:"updateObjects",value:function(){if(this.dirtyTest){var t=!0,e=!1,r=void 0;try{for(var i,a=this.lists[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var n=i.value;if(!n.staticObject){var s=!0,h=!1,l=void 0;try{for(var o,u=n[Symbol.iterator]();!(s=(o=u.next()).done);s=!0){var c=o.value;!c.staticObject&&c[this.dirty]&&(this.updateObject(c),c[this.dirty]=!1)}}catch(t){h=!0,l=t}finally{try{!s&&u.return&&u.return()}finally{if(h)throw l}}}}}catch(t){e=!0,r=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw r}}}else{var y=!0,v=!1,f=void 0;try{for(var d,x=this.lists[Symbol.iterator]();!(y=(d=x.next()).done);y=!0){var b=d.value;if(!b.staticObject){var p=!0,g=!1,m=void 0;try{for(var B,S=b[Symbol.iterator]();!(p=(B=S.next()).done);p=!0){var w=B.value;w.staticObject||this.updateObject(w)}}catch(t){g=!0,m=t}finally{try{!p&&S.return&&S.return()}finally{if(g)throw m}}}}}catch(t){v=!0,f=t}finally{try{!y&&x.return&&x.return()}finally{if(v)throw f}}}}},{key:"updateObject",value:function(t){var e=t.getLocalBounds();t[this.AABB]=t[this.AABB]||{},t[this.AABB].x=t.x+e.x*t.scale.x,t[this.AABB].y=t.y+e.y*t.scale.y,t[this.AABB].width=e.width*t.scale.x,t[this.AABB].height=e.height*t.scale.y}},{key:"query",value:function(t){var e=[],r=!0,i=!1,a=void 0;try{for(var n,s=this.lists[Symbol.iterator]();!(r=(n=s.next()).done);r=!0){var h=n.value,l=!0,o=!1,u=void 0;try{for(var c,y=h[Symbol.iterator]();!(l=(c=y.next()).done);l=!0){var v=c.value,f=v[this.AABB];f.x+f.width>t.x&&f.x-f.width<t.x+t.width&&f.y+f.height>t.y&&f.y-f.height<t.y+t.height&&e.push(v)}}catch(t){o=!0,u=t}finally{try{!l&&y.return&&y.return()}finally{if(o)throw u}}}}catch(t){i=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return e}},{key:"queryCallback",value:function(t,e){var r=!0,i=!1,a=void 0;try{for(var n,s=this.lists[Symbol.iterator]();!(r=(n=s.next()).done);r=!0){var h=n.value,l=!0,o=!1,u=void 0;try{for(var c,y=h[Symbol.iterator]();!(l=(c=y.next()).done);l=!0){var v=c.value,f=v[this.AABB];if(f.x+f.width>t.x&&f.x-f.width<t.x+t.width&&f.y+f.height>t.y&&f.y-f.height<t.y+t.height&&e(v))return!0}}catch(t){o=!0,u=t}finally{try{!l&&y.return&&y.return()}finally{if(o)throw u}}}}catch(t){i=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return!1}},{key:"stats",value:function(){var t=0,e=0,r=!0,i=!1,a=void 0;try{for(var n,s=this.lists[Symbol.iterator]();!(r=(n=s.next()).done);r=!0){n.value.forEach(function(r){t+=r.visible?1:0,e++})}}catch(t){i=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return{total:e,visible:t,culled:e-t}}}]),t}();e.exports=a},{}],3:[function(t,e,r){"use strict";var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}();var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.xSize=e.xSize||e.size||1e3,this.ySize=e.ySize||e.size||1e3,this.AABB=e.type||"AABB",this.spatial=e.spatial||"spatial",this.calculatePIXI=void 0===e.calculatePIXI||e.calculatePIXI,this.visibleText=void 0===e.visibleTest||e.visibleTest,this.simpleTest=void 0===e.simpleTest||e.simpleTest,this.dirtyTest=void 0===e.dirtyTest||e.dirtyTest,this.visible=e.visible||"visible",this.dirty=e.dirty||"dirty",this.width=this.height=0,this.hash={},this.objects=[],this.containers=[]}return i(t,[{key:"add",value:function(t,e){t[this.spatial]={hashes:[]},this.calculatePIXI&&this.dirtyTest&&(t[this.dirty]=!0),e&&(t.staticObject=!0),this.updateObject(t),this.containers[0].push(t)}},{key:"remove",value:function(t){return this.containers[0].splice(this.list[0].indexOf(t),1),this.removeFromHash(t),t}},{key:"addContainer",value:function(t,e){var r=function(t){t[this.spatial]={hashes:[]},this.updateObject(t)}.bind(this),i=function(t){this.removeFromHash(t)}.bind(this),a=!0,n=!1,s=void 0;try{for(var h,l=t.children[Symbol.iterator]();!(a=(h=l.next()).done);a=!0){var o=h.value;o[this.spatial]={hashes:[]},this.updateObject(o)}}catch(t){n=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(n)throw s}}t.cull={},this.containers.push(t),t.on("childAdded",r),t.on("childRemoved",i),t.cull.added=r,t.cull.removed=i,e&&(t.cull.static=!0)}},{key:"removeContainer",value:function(t){var e=this;return this.containers.splice(this.containers.indexOf(t),1),t.children.forEach(function(t){return e.removeFromHash(t)}),t.off("added",t.cull.added),t.off("removed",t.cull.removed),delete t.cull,t}},{key:"cull",value:function(t,e){var r=this;return e||this.updateObjects(),this.invisible(),this.query(t,this.simpleTest).forEach(function(t){return t[r.visible]=!0}),this.lastBuckets}},{key:"invisible",value:function(){var t=this,e=!0,r=!1,i=void 0;try{for(var a,n=this.containers[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){a.value.children.forEach(function(e){return e[t.visible]=!1})}}catch(t){r=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw i}}}},{key:"updateObjects",value:function(){var t=this;if(this.dirtyTest){var e=!0,r=!1,i=void 0;try{for(var a,n=this.objects[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var s=a.value;s[this.dirty]&&(this.updateObject(s),s[this.dirty]=!1)}}catch(t){r=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw i}}var h=!0,l=!1,o=void 0;try{for(var u,c=this.containers[Symbol.iterator]();!(h=(u=c.next()).done);h=!0){var y=u.value,v=!0,f=!1,d=void 0;try{for(var x,b=y.children[Symbol.iterator]();!(v=(x=b.next()).done);v=!0){var p=x.value;p[this.dirty]&&(this.updateObject(p),p[this.dirty]=!1)}}catch(t){f=!0,d=t}finally{try{!v&&b.return&&b.return()}finally{if(f)throw d}}}}catch(t){l=!0,o=t}finally{try{!h&&c.return&&c.return()}finally{if(l)throw o}}}else{var g=!0,m=!1,B=void 0;try{for(var S,w=this.containers[Symbol.iterator]();!(g=(S=w.next()).done);g=!0){var k=S.value;k.cull.static||k.children.forEach(function(e){return t.updateObject(e)})}}catch(t){m=!0,B=t}finally{try{!g&&w.return&&w.return()}finally{if(m)throw B}}}}},{key:"updateObject",value:function(t){var e=void 0;if(this.calculatePIXI){var r=t.getLocalBounds();e=t[this.AABB]={x:t.x+r.x*t.scale.x,y:t.y+r.y*t.scale.y,width:r.width*t.scale.x,height:r.height*t.scale.y}}else e=t[this.AABB];var i=t[this.spatial];i||(i=t[this.spatial]={hashes:[]});var a=this.getBounds(e),n=a.xStart,s=a.yStart,h=a.xEnd,l=a.yEnd;if(i.xStart!==n||i.yStart!==s||i.xEnd!==h||i.yEnd!==l){i.hashes.length&&this.removeFromHash(t);for(var o=s;o<=l;o++)for(var u=n;u<=h;u++){var c=u+","+o;this.insert(t,c),i.hashes.push(c)}i.xStart=n,i.yStart=s,i.xEnd=h,i.yEnd=l}}},{key:"getBuckets",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=[];for(var r in this.hash){var i=this.hash[r];i.length>=t&&e.push(i)}return e}},{key:"getBounds",value:function(t){return{xStart:Math.floor(t.x/this.xSize),yStart:Math.floor(t.y/this.ySize),xEnd:Math.floor((t.x+t.width)/this.xSize),yEnd:Math.floor((t.y+t.height)/this.ySize)}}},{key:"insert",value:function(t,e){this.hash[e]?this.hash[e].push(t):this.hash[e]=[t]}},{key:"removeFromHash",value:function(t){for(var e=t[this.spatial];e.hashes.length;){var r=e.hashes.pop(),i=this.hash[r];i.splice(i.indexOf(t),1)}}},{key:"neighbors",value:function(t){var e=this,r=[];return t[this.spatial].hashes.forEach(function(t){return r=r.concat(e.hash[t])}),r}},{key:"query",value:function(t,e){e=void 0===e||e;for(var r=0,i=[],a=this.getBounds(t),n=a.xStart,s=a.yStart,h=a.xEnd,l=a.yEnd,o=s;o<=l;o++)for(var u=n;u<=h;u++){var c=this.hash[u+","+o];if(c){if(e){var y=!0,v=!1,f=void 0;try{for(var d,x=c[Symbol.iterator]();!(y=(d=x.next()).done);y=!0){var b=d.value,p=b[this.AABB];p.x+p.width>t.x&&p.x<t.x+t.width&&p.y+p.height>t.y&&p.y<t.y+t.height&&i.push(b)}}catch(t){v=!0,f=t}finally{try{!y&&x.return&&x.return()}finally{if(v)throw f}}}else i=i.concat(c);r++}}return this.lastBuckets=r,i}},{key:"queryCallback",value:function(t,e,r){r=void 0===r||r;for(var i=this.getBounds(t),a=i.xStart,n=i.yStart,s=i.xEnd,h=i.yEnd,l=n;l<=h;l++)for(var o=a;o<=s;o++){var u=this.hash[o+","+l];if(u)for(var c=0;c<u.length;c++){var y=u[c];if(r){var v=y.AABB;if(v.x+v.width>v.x&&v.x<v.x+v.width&&v.y+v.height>v.y&&v.y<v.y+v.height&&e(y))return!0}else if(e(y))return!0}}return!1}},{key:"stats",value:function(){var t=0,e=0,r=!0,i=!1,a=void 0;try{for(var n,s=this.containers[Symbol.iterator]();!(r=(n=s.next()).done);r=!0)for(var h=n.value,l=0;l<h.children.length;l++){t+=h.children[l].visible?1:0,e++}}catch(t){i=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return{total:e,visible:t,culled:e-t}}},{key:"getNumberOfBuckets",value:function(){return Object.keys(this.hash).length}},{key:"getAverageSize",value:function(){var t=0;for(var e in this.hash)t+=this.hash[e].length;return t/this.getBuckets().length}},{key:"getLargest",value:function(){var t=0;for(var e in this.hash)this.hash[e].length>t&&(t=this.hash[e].length);return t}},{key:"getWorldBounds",value:function(){var t=1/0,e=1/0,r=0,i=0;for(var a in this.hash){var n=a.split(","),s=parseInt(n[0]),h=parseInt(n[1]);t=s<t?s:t,e=h<e?h:e,r=s>r?s:r,i=h>i?h:i}return{xStart:t,yStart:e,xEnd:r,yEnd:i}}},{key:"getSparseness",value:function(t){for(var e=0,r=0,i=t?this.getBounds(t):this.getWorldBounds(),a=i.xStart,n=i.yStart,s=i.xEnd,h=i.yEnd,l=n;l<h;l++)for(var o=a;o<s;o++)e+=this.hash[o+","+l]?1:0,r++;return e/r}}]),t}();e.exports=a},{}]},{},[1]);